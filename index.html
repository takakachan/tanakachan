<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Catch Pulse</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <a href="#" class="logo" onclick="goHome(event)"><span>●</span> Catch Pulse</a>
    <nav class="nav" aria-label="Main navigation">
      <button class="nav-btn active" data-mode="grid" onclick="setMode('grid')">Explorer</button>
      <button class="nav-btn" data-mode="tinder" onclick="setMode('tinder')">Swipe</button>
      <button class="nav-btn" data-mode="likes" onclick="setMode('likes')">Collected</button>
      <button class="nav-btn" data-mode="nope" onclick="setMode('nope')">Nope</button>
    </nav>
    <div class="header-actions">
      <button class="demo-btn" onclick="loadDemoData()">Load Demo Data</button>
      <div class="search-box" id="search-box">
        <span class="search-icon"><svg viewBox="0 0 24 24" style="width:16px;height:16px;fill:currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></span>
        <input type="text" class="search-input" placeholder="Search..." id="search-input" oninput="handleSearch(this.value)">
        <button class="search-clear" onclick="clearSearch()">×</button>
      </div>
      <button class="action-btn" onclick="toggleSearch()" title="Search (⌘F)"><svg viewBox="0 0 24 24" style="width:18px;height:18px;fill:currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></button>
      <button class="action-btn" onclick="refreshAll()" title="Refresh"><svg viewBox="0 0 24 24" style="width:18px;height:18px;fill:currentColor"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg></button>
      <button class="action-btn" onclick="openSettings()" title="Settings"><svg viewBox="0 0 24 24" style="width:18px;height:18px;fill:currentColor"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg></button>
    </div>
  </header>
  <nav class="mobile-nav" aria-label="Mobile navigation">
    <button class="mobile-nav-btn active" data-mode="grid" onclick="setMode('grid')">
      <span class="mobile-nav-icon"><svg viewBox="0 0 24 24" style="width:20px;height:20px;fill:currentColor"><path d="M3 3v8h8V3H3zm6 6H5V5h4v4zm-6 4v8h8v-8H3zm6 6H5v-4h4v4zm4-16v8h8V3h-8zm6 6h-4V5h4v4zm-6 4v8h8v-8h-8zm6 6h-4v-4h4v4z"/></svg></span>
      <span>Explorer</span>
    </button>
    <button class="mobile-nav-btn" data-mode="tinder" onclick="setMode('tinder')">
      <span class="mobile-nav-icon"><svg viewBox="0 0 24 24" style="width:20px;height:20px;fill:currentColor"><path d="M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"/></svg></span>
      <span>Swipe</span>
    </button>
    <button class="mobile-nav-btn" data-mode="likes" onclick="setMode('likes')">
      <span class="mobile-nav-icon"><svg viewBox="0 0 24 24" style="width:20px;height:20px;fill:currentColor"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg></span>
      <span>Saved</span>
    </button>
    <button class="mobile-nav-btn" data-mode="nope" onclick="setMode('nope')">
      <span class="mobile-nav-icon"><svg viewBox="0 0 24 24" style="width:20px;height:20px;fill:currentColor"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"/></svg></span>
      <span>Nope</span>
    </button>
  </nav>
  <main>
    <div id="grid-view">
      <div class="filter-bar">
        <div class="filter-bar-left">
          <button class="multi-select-toggle" id="multi-select-toggle" onclick="toggleMultiSelect()"><svg viewBox="0 0 24 24" style="width:14px;height:14px;fill:currentColor;margin-right:6px"><path d="M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2z"/></svg> Select</button>
        </div>
        <div class="filter-bar-right">
          <select class="sort-select" id="sort-select" onchange="handleSort(this.value)">
            <option value="newest">Newest</option>
            <option value="oldest">Oldest</option>
            <option value="title">Title A-Z</option>
          </select>
          <div class="size-selector">
            <button class="size-btn active" onclick="setCardSize('small')" title="Small (minimal)">S</button>
            <button class="size-btn" onclick="setCardSize('medium')" title="Medium (2 cols)">M</button>
            <button class="size-btn" onclick="setCardSize('large')" title="Large (1 col)">L</button>
          </div>
        </div>
      </div>
      <div class="stats-bar">
        <div class="stat"><span class="stat-num" id="total-count">0</span><span class="stat-label">Total</span></div>
        <div class="stat"><span class="stat-num" id="like-count">0</span><span class="stat-label">Collected</span></div>
        <div class="stat"><span class="stat-num" id="nope-count">0</span><span class="stat-label">Nope</span></div>
      </div>
      <div class="masonry" id="cards"></div>
    </div>
    <div class="tinder-view" id="tinder-view">
      <div class="tinder-progress-wrap">
        <div class="tinder-progress-bar">
          <div class="tinder-progress-fill" id="tinder-progress-fill"></div>
        </div>
        <div class="tinder-progress-text" id="tinder-progress-text"></div>
      </div>
      <div class="tinder-stack">
        <div class="tinder-card" id="tinder-card">
          <div class="tinder-stamp like">LIKE</div>
          <div class="tinder-stamp nope">NOPE</div>
          <img class="tinder-img" id="tinder-img" src="" alt="">
          <div class="tinder-content">
            <div class="tinder-type" id="tinder-type"></div>
            <div class="tinder-title" id="tinder-title"></div>
            <div class="tinder-source" id="tinder-source"></div>
          </div>
        </div>
      </div>
      <div class="tinder-controls">
        <button class="tinder-btn nope" onclick="tinderNope()" title="Pass (←)" aria-label="Pass"><svg viewBox="0 0 24 24" style="width:28px;height:28px;fill:currentColor"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"/></svg></button>
        <button class="tinder-btn undo" onclick="undoLast()" title="Undo" aria-label="Undo"><svg viewBox="0 0 24 24" style="width:28px;height:28px;fill:currentColor"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"/></svg></button>
        <button class="tinder-btn like" onclick="tinderLike()" title="Collect (→)" aria-label="Collect"><svg viewBox="0 0 24 24" style="width:28px;height:28px;fill:currentColor"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg></button>
      </div>
      <div class="tinder-hint">Use <span class="kbd">←</span> <span class="kbd">→</span> or swipe</div>
    </div>
    <div class="section-view" id="likes-view">
      <div class="filter-bar">
        <select class="sort-select" id="likes-sort-select" onchange="handleLikesSort(this.value)">
          <option value="newest">Newest</option>
          <option value="oldest">Oldest</option>
          <option value="title">Title A-Z</option>
        </select>
        <div class="size-selector">
          <button class="size-btn active" onclick="setCardSize('small')" title="Small">S</button>
          <button class="size-btn" onclick="setCardSize('medium')" title="Medium">M</button>
          <button class="size-btn" onclick="setCardSize('large')" title="Large">L</button>
        </div>
      </div>
      <div class="section-header">
        <div>
          <h2 class="section-title">Collected</h2>
          <p class="section-desc">Saved content for later</p>
        </div>
        <span class="section-count" id="likes-count-badge">0</span>
      </div>
      <div class="masonry" id="likes-cards"></div>
    </div>
    <div class="section-view" id="nope-view">
      <div class="filter-bar">
        <select class="sort-select" id="nope-sort-select" onchange="handleNopeSort(this.value)">
          <option value="newest">Newest</option>
          <option value="oldest">Oldest</option>
          <option value="title">Title A-Z</option>
        </select>
        <div class="size-selector">
          <button class="size-btn active" onclick="setCardSize('small')" title="Small">S</button>
          <button class="size-btn" onclick="setCardSize('medium')" title="Medium">M</button>
          <button class="size-btn" onclick="setCardSize('large')" title="Large">L</button>
        </div>
      </div>
      <div class="section-header">
        <div>
          <h2 class="section-title">Nope</h2>
          <p class="section-desc">Content you've passed on</p>
        </div>
        <span class="section-count" id="nope-count-badge">0</span>
      </div>
      <div class="masonry" id="nope-cards"></div>
    </div>
  </main>
  <div class="modal" id="settings-modal" role="dialog" aria-modal="true">
    <div class="modal-inner">
      <div class="modal-header">
        <h2 class="modal-title">Settings</h2>
        <button class="modal-close" onclick="closeSettings()"><svg viewBox="0 0 24 24" style="width:20px;height:20px;fill:currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Add RSS Feed</label>
          <input type="text" class="form-input" id="rss-url" placeholder="RSS URL (e.g., https://example.com/feed.xml)" style="width:100%;padding:10px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:0.85rem;margin-bottom:8px;">
          <input type="text" class="form-input" id="rss-genre" placeholder="Genre (e.g., Blog, Podcast, YouTube, Tech, News)" style="width:100%;padding:10px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:0.85rem;margin-bottom:8px;">
          <button class="btn" onclick="addRssFeed()" style="margin-bottom:16px;">Add RSS Feed</button>
        </div>
        <div class="form-group">
          <label class="form-label">Registered RSS Feeds</label>
          <div id="rss-feeds-list" style="max-height:150px;overflow-y:auto;margin-bottom:16px;"></div>
        </div>
        <button class="btn" onclick="fetchAllRss()" style="background:var(--bg3);border-color:var(--border);">Fetch All RSS Feeds</button>
        <hr style="border:none;border-top:1px solid var(--border);margin:20px 0;">
        <div class="demo-badge">
          <span>●</span> Demo Mode Active
        </div>
        <div class="form-group">
          <label class="form-label">Content Category</label>
          <select class="form-select" id="demo-source" onchange="updateDemoSource()">
            <option value="tech">Tech & Code</option>
            <option value="entertainment">Film & Entertainment</option>
            <option value="news">News</option>
            <option value="science">Science</option>
            <option value="podcast">Podcasts</option>
          </select>
        </div>
        <button class="btn" onclick="loadDemoData()">Load Demo Data</button>
      </div>
    </div>
  </div>
  <div class="confirm" id="confirm">
    <div class="confirm-box">
      <div class="confirm-icon"><svg viewBox="0 0 24 24" style="width:48px;height:48px;fill:currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg></div>
      <div class="confirm-title" id="confirm-title">Remove?</div>
      <div class="confirm-text" id="confirm-text">This cannot be undone</div>
      <div class="confirm-actions">
        <button class="confirm-btn cancel" onclick="closeConfirm()">Cancel</button>
        <button class="confirm-btn danger" onclick="confirmDelete()">Remove</button>
      </div>
    </div>
  </div>
  <div class="toast-container" id="toasts"></div>
  <div class="batch-bar" id="batch-bar">
    <span class="batch-bar-count" id="batch-count">0 selected</span>
    <div class="batch-bar-actions">
      <button class="batch-btn like" onclick="batchLike()"><svg viewBox="0 0 24 24" style="width:14px;height:14px;fill:currentColor;margin-right:6px"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg> Collect</button>
      <button class="batch-btn nope" onclick="batchNope()"><svg viewBox="0 0 24 24" style="width:14px;height:14px;fill:currentColor;margin-right:6px"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"/></svg> Nope</button>
      <button class="batch-btn cancel" onclick="cancelSelection()">Cancel</button>
    </div>
  </div>
  <script src="app.js"></script>
  <script>init();</script>
</body>
</html>
